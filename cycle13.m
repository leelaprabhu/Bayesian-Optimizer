function dg2 = cycle13(t,g2,param)
% R=[20.0, 19.608, 16.373, 15.789, 12.185, 11.906];
% T=[[-0.068, -0.073, -0.050, -0.056, -0.038, -0.034];
%    [0.022, 0.019, 0.001, 0.011, -0.166, 0.003];
%    [0.033, -0.014, 0.017, -0.076, -0.015, -0.080];
%    [0.029, -0.018, -0.110, 0.011, -0.001, -0.020];
%    [0.037, -0.027, -0.024, -0.090, 0.045, -0.077];
%    [-0.018, -0.106, -0.106, -0.082, -0.137, -0.003]];
% m=[-0.040, 0.050, 0.129, 0.177, 0.097, -0.007];
% h=[13.459, -3.500, -3.500, -3.500, -3.500, 8.173];
% D=[0.200, 0.200, 0.200, 0.142, 0.200, 0.200];
% t1_2=[18.000, 7.254, 8.980, 9.577, 12.499, 16.842];

% R=[     12.812132,   22.786520,  21.588263,  22.815352,  22.037550,  17.954936];
% T=[[    -0.012352,  -0.018824,  -0.017068,  -0.026927,  -0.015665,  -0.014759];
%    [    0.015132,   0.019551,   0.001516,   0.013021,   -0.075834,  0.003674];
%    [    0.026518,   0.003393,   0.013070,   -0.031618,  -0.001788,  -0.064934];
%    [    0.021691,   -0.001633,  -0.052101,  0.016053,   0.004754,   -0.008446];
%    [    0.026775,   -0.068373,  0.001791,   -0.000240,  0.011534,   -0.056754];
%    [    0.034919,   -0.013708,  -0.079439,  -0.023317,  -0.042635,  -0.010401]];
% m= [    -0.032025,  0.032262,   0.025170,   0.052421,   0.021895,   -0.025229];
% h=[     3.646139,   -3.500,     -3.500,     -3.500,     -3.500,     -3.753219];
% D=[     0.00,       0.00,       0.00,       0.00,       0.00,       0.00];
% t1_2=[  19.838265,  5.990225,   7.335732,   6.147511,   7.866904,   13.204312];

R=param(1:6);
T=reshape(param(7:42),[6,6])';
m=param(43:48);
h=param(49:54);
D=param(55:60);
t1_2=param(61:66);

%v16=[78.77,    104.27,    28.35,    43.22,    0.0,    20.69];
%v47=[104.26,    7.56,       15.42,    40.34,    0.0,    26.88];

v16=[16.1715, 84.1231, 3.7073, 21.8449, 0.0, 4.5687];
v47=[71.2478, 0.0, 0.0742, 12.6101, 0.0, 21.1006];
% v16=[101.62,    23.0600,    24.7100,    50.1900,    0.0,    16.3800];
% v47=[115.92,    1.94,       12.8200,    32.8900,    0.0,    3.0800];
%load('bcd13j12.mat')
%v16=zeros(1,6);
%v47=zeros(1,6);
%cadinit=[101.62,  113.87,  128.22,  139.85,  151.39,  161.02,  169.08, 169.94,  168.47,  163.05,  158.15,  150.39,  143.34,  136.45, 131.39,  115.92];
%cadinit=[101.620000000000,101.620000000000,113.870000000000,113.870000000000,128.220000000000,128.220000000000,139.850000000000,139.850000000000,151.390000000000,151.390000000000,161.020000000000,161.020000000000,169.080000000000,169.080000000000,169.940000000000,169.940000000000,168.470000000000,168.470000000000,163.050000000000,163.050000000000,158.150000000000,158.150000000000,150.390000000000,150.390000000000,143.340000000000,143.340000000000,136.450000000000,136.450000000000,131.390000000000,131.390000000000,115.920000000000,115.920000000000];
%hbinit=[ 23.06,  19.45,  15.1 ,  12.13,   8.22,   6.96,   5.73,   4.23, 3.61,   3.47,   2.99,   2.69,   2.11,   2.  ,   1.94,   1.94];
%hbinit=[23.0600000000000,23.0600000000000,19.4500000000000,19.4500000000000,15.1000000000000,15.1000000000000,12.1300000000000,12.1300000000000,8.22000000000000,8.22000000000000,6.96000000000000,6.96000000000000,5.73000000000000,5.73000000000000,4.23000000000000,4.23000000000000,3.61000000000000,3.61000000000000,3.47000000000000,3.47000000000000,2.99000000000000,2.99000000000000,2.69000000000000,2.69000000000000,2.11000000000000,2.11000000000000,2,2,1.94000000000000,1.94000000000000,1.94000000000000,1.94000000000000];
%bcd=[ 63.4 ,  58.24,  53.41,  49.68,  46.23,  42.68,  39.66,  36.95, 34.56,  32.08,  30.18,  28.36,  26.76,  25.27,  23.86,  22.68, 21.5 ,  20.17,  19.19,  18.22,  17.23,  16.37,  15.58,  14.8 , 14.09,  13.45,  13.1 ,  12.87,  12.68,  12.17];
% bcd=[61.2150
%    58.8762
%    57.5663
%    55.3487
%    53.6500
%    52.5938
%    51.3050
%    49.2875
%    47.9163
%    46.6938
%    45.6725
%    44.2463
%    43.1363
%    41.9650
%    40.8588
%    39.7288
%    38.3625
%    38.0400
%    36.8912
%    36.4438
%    35.2188
%    34.6212
%    34.0575
%    33.4763
%    32.5712
%    32.2788
%    31.5300
%    30.8425
%    30.1463
%    29.5750
%    28.9100
%    28.8925
%    28.3038
%    27.7575
%    27.5087
%    26.9387
%    26.6250
%    26.3438
%    25.9138
%    25.0437
%    24.8100
%    24.2325
%    24.0287
%    24.1650
%    23.3887
%    23.0925
%    22.4250
%    22.2475
%    21.6538
%    21.3287
%    21.1325
%    20.5425
%    20.3012
%    19.6775
%    19.3725
%    19.0063
%    18.0075
%    17.5900];   

bcd13=[48.6358000000000;42.9921000000000;37.7887000000000;33.7036000000000;30.0328000000000;26.3906000000000;23.1281000000000;20.0768000000000;17.5529000000000;15.0432000000000;13.0399000000000;11.3939000000000;9.79320000000000;8.46660000000000;7.19760000000000;6.22400000000000;5.09610000000000;3.99670000000000;3.22710000000000;2.49720000000000;1.80690000000000;1.32970000000000;0.940500000000000;0.370500000000000;0.0797000000000000;0;0;0.267400000000000;0.521200000000000;0.381300000000000];
dg=zeros(6,30);
g=reshape(g2,[30,6])';
for a=1:6
    for i=1:30
        Tv=T(a,1)*g(1,i)+T(a,2)*g(2,i)+T(a,3)*g(3,i)+T(a,4)*g(4,i)+T(a,5)*g(5,i)+T(a,6)*g(6,i);
        ua=Tv+m(a)*bcd13(i)+h(a);
        if(i==1)
           vv=(v16(a)-g(a,i))+(g(a,i+1)-g(a,i));
        elseif (i==30)
           vv=(g(a,i-1)-g(a,i))+(v47(a)-g(a,i));
        else
           vv=(g(a,i-1)-g(a,i))+(g(a,i+1)-g(a,i));    
        end
        lmbd=log(2.0)/t1_2(a);
        dg(a,i)=R(a)*0.5*(ua/((ua^2.0+1)^0.5)+1)+D(a)*vv-lmbd*g(a,i);
    end 
end   
%size(dg)
dg2=reshape(dg',[1,180])';

% dg=zeros(180,1);
% for a=1:6
%     for i=1:30
%         Tv=T(a,1)*g(i)+T(a,2)*g(30+i)+T(a,3)*g(30*2+i)+T(a,4)*g(30*3+i)+T(a,5)*g(30*4+i)+T(a,6)*g(30*5+i);
%         ua=Tv+m(a)*bcd(i)+h(a);
%         if(i==1)
%            vv=(v16(a)-g((a-1)*30+i))+(g((a-1)*30+i+1)-g((a-1)*30+i));
%         elseif (i==30)
%            vv=(g((a-1)*30+i-1)-g((a-1)*30+i))+(v47(a)-g((a-1)*30+i));
%         else
%            vv=(g((a-1)*30+i-1)-g((a-1)*30+i))+(g((a-1)*30+i+1)-g((a-1)*30+i));    
%         end
%         lmbd=log(2.0)/t1_2(a);
%         sa=0.5*(ua/((ua^2.0+1)^0.5)+1);
%         dg((a-1)*30+i)=R(a)*sa+D(a)*vv-lmbd*g((a-1)*30+i);
%     end 
% end    


    
